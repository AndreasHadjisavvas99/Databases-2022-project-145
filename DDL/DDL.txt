-- This script was generated by a beta version of the ERD tool in pgAdmin 4.
-- Please log an issue at https://redmine.postgresql.org/projects/pgadmin4/issues/new if you find any bugs, including reproduction steps.
BEGIN;


CREATE TABLE IF NOT EXISTS public.company
(
    company_id integer NOT NULL,
    equity integer,
    CONSTRAINT company_pkey PRIMARY KEY (company_id)
);

CREATE TABLE IF NOT EXISTS public.deliverables
(
    deliver_id integer NOT NULL,
    title character varying COLLATE pg_catalog."default",
    summary character varying COLLATE pg_catalog."default",
    date_of_delivery date,
    project_id integer,
    CONSTRAINT deliverables_pkey PRIMARY KEY (deliver_id)
);

CREATE TABLE IF NOT EXISTS public.executive
(
    exec_id integer NOT NULL,
    name character varying COLLATE pg_catalog."default",
    CONSTRAINT executive_pkey PRIMARY KEY (exec_id)
);

CREATE TABLE IF NOT EXISTS public.organization
(
    org_id integer NOT NULL,
    abbreviation character varying COLLATE pg_catalog."default",
    name character varying COLLATE pg_catalog."default",
    postcode character varying COLLATE pg_catalog."default",
    city character varying COLLATE pg_catalog."default",
    street_name character varying COLLATE pg_catalog."default",
    phone_number character varying COLLATE pg_catalog."default",
    company_id integer,
    resce_id integer,
    id_university integer,
    CONSTRAINT organization_pkey PRIMARY KEY (org_id)
);

CREATE TABLE IF NOT EXISTS public.programm
(
    programm_id integer NOT NULL,
    address character varying COLLATE pg_catalog."default",
    name character varying COLLATE pg_catalog."default",
    CONSTRAINT programm_pkey PRIMARY KEY (programm_id)
);

CREATE TABLE IF NOT EXISTS public.project
(
    project_id integer NOT NULL,
    title character varying COLLATE pg_catalog."default",
    summary character varying COLLATE pg_catalog."default",
    start_date date,
    end_date date,
    duration integer,
    funding numeric,
    programm_id integer,
    exec_id integer,
    supervisor_id integer,
    org_id integer,
    grader_id integer,
    grade integer,
    grade_date date,
    CONSTRAINT project_pkey PRIMARY KEY (project_id)
);

CREATE TABLE IF NOT EXISTS public.researchcenter
(
    resce_id integer NOT NULL,
    govbudg integer,
    privbudg integer,
    CONSTRAINT "ResearchCenter_pkey" PRIMARY KEY (resce_id)
);

CREATE TABLE IF NOT EXISTS public.researcher
(
    researcher_id integer NOT NULL,
    first_name character varying COLLATE pg_catalog."default",
    last_name character varying COLLATE pg_catalog."default",
    date_of_birth date,
    gender "char",
    date_start_org date,
    org_id integer,
    CONSTRAINT researcher_pkey PRIMARY KEY (researcher_id)
);

CREATE TABLE IF NOT EXISTS public.scientific_field
(
    field_id integer NOT NULL,
    name character varying COLLATE pg_catalog."default",
    CONSTRAINT scientific_field_pkey PRIMARY KEY (field_id)
);

CREATE TABLE IF NOT EXISTS public.scientific_field_project
(
    field_id integer NOT NULL,
    project_id integer NOT NULL,
    CONSTRAINT scientific_field_project_pkey PRIMARY KEY (field_id, project_id)
);

CREATE TABLE IF NOT EXISTS public.university
(
    id_university integer NOT NULL,
    govbudg integer,
    CONSTRAINT university_pkey PRIMARY KEY (id_university)
);

CREATE TABLE IF NOT EXISTS public.works_on_project
(
    researcher_id integer NOT NULL,
    project_id integer NOT NULL,
    CONSTRAINT works_on_project_pkey PRIMARY KEY (researcher_id, project_id)
);

ALTER TABLE IF EXISTS public.deliverables
    ADD CONSTRAINT deliverables_project_id_fkey FOREIGN KEY (project_id)
    REFERENCES public.project (project_id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION
    NOT VALID;


ALTER TABLE IF EXISTS public.organization
    ADD CONSTRAINT organization_company_id_fkey FOREIGN KEY (company_id)
    REFERENCES public.company (company_id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION
    NOT VALID;


ALTER TABLE IF EXISTS public.organization
    ADD CONSTRAINT organization_id_university_fkey FOREIGN KEY (id_university)
    REFERENCES public.university (id_university) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION
    NOT VALID;


ALTER TABLE IF EXISTS public.organization
    ADD CONSTRAINT organization_resce_id_fkey FOREIGN KEY (resce_id)
    REFERENCES public.researchcenter (resce_id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION
    NOT VALID;


ALTER TABLE IF EXISTS public.project
    ADD CONSTRAINT project_advisor_id_fkey FOREIGN KEY (supervisor_id)
    REFERENCES public.researcher (researcher_id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION
    NOT VALID;


ALTER TABLE IF EXISTS public.project
    ADD CONSTRAINT project_exec_id_fkey FOREIGN KEY (exec_id)
    REFERENCES public.executive (exec_id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION
    NOT VALID;


ALTER TABLE IF EXISTS public.project
    ADD CONSTRAINT project_grader_id_fkey FOREIGN KEY (grader_id)
    REFERENCES public.researcher (researcher_id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION
    NOT VALID;


ALTER TABLE IF EXISTS public.project
    ADD CONSTRAINT project_org_id_fkey FOREIGN KEY (org_id)
    REFERENCES public.organization (org_id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION
    NOT VALID;


ALTER TABLE IF EXISTS public.project
    ADD CONSTRAINT project_programm_id_fkey FOREIGN KEY (programm_id)
    REFERENCES public.programm (programm_id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION
    NOT VALID;


ALTER TABLE IF EXISTS public.scientific_field_project
    ADD CONSTRAINT scientific_field_project_field_id_fkey FOREIGN KEY (field_id)
    REFERENCES public.scientific_field (field_id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION
    NOT VALID;


ALTER TABLE IF EXISTS public.scientific_field_project
    ADD CONSTRAINT scientific_field_project_project_id_fkey FOREIGN KEY (project_id)
    REFERENCES public.project (project_id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION
    NOT VALID;


ALTER TABLE IF EXISTS public.works_on_project
    ADD CONSTRAINT works_on_project_project_id_fkey FOREIGN KEY (project_id)
    REFERENCES public.project (project_id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION
    NOT VALID;


ALTER TABLE IF EXISTS public.works_on_project
    ADD CONSTRAINT works_on_project_researcher_id_fkey FOREIGN KEY (researcher_id)
    REFERENCES public.researcher (researcher_id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION
    NOT VALID;

END;